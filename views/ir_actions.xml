<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <record id="view_ir_action_inherit_form" model="ir.ui.view">
            <field name="name">ir.actions.report.form</field>
            <field name="model">ir.actions.report</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="base.act_report_xml_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='report_type']" position="after">
                    <field name="custom_report_background" select="1"/>
                    <field name="custom_report_type" attrs="{'invisible':
                        [('custom_report_background', '!=', True)]}"/>
                    <field name="custom_report_background_image"
                        attrs="{'invisible': ['|', ('custom_report_type','!=',
                        'report'), ('custom_report_background', '!=', True)]}"/>
                </xpath>
                <xpath expr="//notebook" position="inside">
                    <page string="Background Configuration" attrs="{'invisible':
                        [('custom_report_type','!=', 'dynamic')]}">
                        <field name="background_ids">
                            <form>
                                <sheet>
                                    <group>
                                        <group>
                                            <field name="type" />
                                            <field name="page_number"
                                                attrs="{'invisible': [('type', '!=', 'fixed')]}" />
                                            <field name="page_expression"
                                                attrs="{'invisible': [('type', '!=', 'expression')]}" />
                                        </group>
                                        <group>
                                            <field name="background_pdf" />
                                            <field name="report_id" invisible="1" />
                                        </group>
                                    </group>
                                </sheet>
                            </form>
                            <tree>
                                <field name="type" />
                                <field name="page_number" invisible="1" />
                                <field name="page_expression" invisible="1" />
                                <field name="background_pdf" />
                                <field name="report_id" invisible="1" />
                            </tree>
                        </field>
                        <i class="fa fa-info fa-3x text-info float-left" role="img" aria-label="Info" title="Info"/>
                        <h3>Interaction between Background Configuration</h3>
                        <div>
                            <p>
                                You can set the backgroud watermark in report based on Background Configuration.
                            </p>
                            <p>
                                Detailed algorithm (with priorities):
                                <ol>
                                    <li>
                                        <b>First Page : </b>
                                        On the First Page select, it will not check other configurations for the first page. it will only set the first page background pdf.<br/>
                                        If on the first page there was not added the background pdf then it will set background pdf from the fixed page or expression page or remaining pages.
                                    </li>
                                    <li>
                                        <b>Last Page : </b>
                                        On the Last Page select, it will not check other configurations for the last page. it will only set the last page background pdf.<br/>
                                        If on the last page there was not added the background pdf then it will set background pdf from the fixed page or expression page or remaining pages.
                                    </li>
                                    <li>
                                        <b>Fixed Pages : </b>
                                        On the Fixed page select, the entered page number will set the fixed page's background pdf. <br/>
                                        If the entered page number is first and last then it will set background from first and last if we configured the first page and the last page otherwise it will set from the fixed page.
                                    </li>
                                    <li>
                                        <b>Expression : </b>
                                        On the Expression select, based on the expression value it will set the expression's background pdf. if the page is not the first page or the last page or the fixed page.
                                        <br/>Example of expression:
                                        result=page%2==0 <b> OR </b> result=page>3
                                    </li>
                                    <li>
                                        <b>Remaining Pages : </b>
                                        On the Remaining page select, if not set background pdf for pages or not set the configuration of pages then it will set from the remaining pages.
                                    </li>
                                </ol>
                                Extra Note
                                <li>
                                    If no background PDF has been configured for any line, then it will work as normal Odoo report without any extra background.
                                </li>
                            </p>
                        </div>
                    </page>
                </xpath>
            </field>
        </record>
    </data>
</odoo>
